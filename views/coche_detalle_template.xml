<odoo>
    <template id="coche_detalle_template" name="Detalle del Coche">
        <t t-call="web.layout">
            <!--
            Plantilla QWeb: coche_detalle_template

            Descripción general:
            - Muestra el detalle completo de un coche incluyendo imagen, precio, estado,
              antigüedad, marca y propietario.
            - Incluye diseño estético usando Bootstrap 5 y Bootstrap Icons.

            Conceptos Odoo/QWeb usados:

            1. t-call="web.layout"
               - Extiende la plantilla base de Odoo para mantener encabezado, footer y estilos comunes.

            2. t-if / t-else
               - Condicionales de QWeb para mostrar la imagen del coche si existe,
                 o un placeholder si no hay imagen.

            3. t-att-src
               - Asigna dinámicamente el atributo 'src' del <img> con la imagen del coche
                 codificada en Base64.

            4. t-esc
               - Escapa el contenido para mostrar datos de manera segura:
                 - coche.name, coche.precio, coche.estado, coche.antiguedad, coche.marca_id.name,
                   coche.propietario_id.name

            5. t-att-class
               - Permite definir dinámicamente clases CSS según condición
                 - Por ejemplo, cambia el color del badge según si el coche es 'nuevo' o 'usado'.

            6. Bootstrap 5
               - Uso de contenedores (container), filas (row), columnas (col-*), tarjetas (card),
                 badges, botones (btn) y utilidades de espaciado y sombra (shadow, p-3, my-5, me-2).
               - Hace que la vista sea responsive y visualmente atractiva.

            7. Bootstrap Icons
               - Se incluyen para mostrar iconos en botones:
                 - bi-arrow-left-circle para "Volver al listado"
                 - bi-cart-plus para "Comprar"

            8. Diseño responsive
               - Imagen y texto distribuidos en columnas col-lg-6 para escritorio
                 y flex-column para centrar verticalmente el contenido en pantallas grandes.

            9. Manejo de datos relacionales
               - coche.marca_id.name: Many2one hacia Marca
               - coche.propietario_id.name: Many2one hacia Cliente
               - Se usa condición para mostrar 'Sin propietario' si no tiene propietario.

            Requisitos cumplidos:

            * Bootstrap en la vista: Sí, diseño responsive y tarjetas con sombra
            * Manejo de relaciones Many2one: coche.marca_id y coche.propietario_id
            * Manejo de datos dinámicos con QWeb: t-esc, t-att-src, t-att-class
            * Condiciones dinámicas: t-if / t-else
            * Estética: badges de estado, espaciado, sombras, botones con iconos
            -->
            
            <!-- Incluir Bootstrap CSS y JS -->
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"/>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

            <!-- Incluir Bootstrap Icons en el head -->
            <t t-set="head" t-value="head or ''">
                <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"/>
            </t>
            
            <div class="container my-5">
                <div class="card shadow-lg rounded-4 p-3">
                    <div class="row g-3">
                        <!-- Imagen del coche -->
                        <div class="col-lg-6 text-center">
                            <t t-if="coche.image">
                                <img t-att-src="'data:image/png;base64,%s' % (coche.image.decode() if isinstance(coche.image, bytes) else coche.image)"
                                     class="img-fluid rounded-3 shadow-sm" style="max-height:400px; object-fit:cover;" />
                            </t>
                            <t t-else="">
                                <img src="https://via.placeholder.com/800x400?text=Sin+imagen"
                                     class="img-fluid rounded-3 shadow-sm" style="max-height:400px; object-fit:cover;" />
                            </t>
                        </div>

                        <!-- Información del coche -->
                        <div class="col-lg-6 d-flex flex-column justify-content-center">
                            <h2 class="card-title mb-3"><t t-esc="coche.name"/></h2>
                            <p class="card-text mb-2"><strong>Precio:</strong> <span class="text-success fs-5"><t t-esc="coche.precio"/> €</span></p>
                            <p class="card-text mb-2"><strong>Estado:</strong> 
                                <span t-att-class="'badge ' + ('bg-success' if coche.estado=='nuevo' else 'bg-warning text-dark')">
                                    <t t-esc="coche.estado.capitalize()"/>
                                </span>
                            </p>
                            <p class="card-text mb-2"><strong>Antigüedad:</strong> 
                                <span class="badge bg-info text-dark"><t t-esc="coche.antiguedad"/> años</span>
                            </p>
                            <p class="card-text mb-2"><strong>Marca:</strong> <t t-esc="coche.marca_id.name"/></p>
                            <p class="card-text mb-2"><strong>Propietario:</strong> 
                                <t t-esc="coche.propietario_id.name if coche.propietario_id else 'Sin propietario'"/>
                            </p>

                            <!-- Botones -->
                            <div class="mt-4">
                                <a href="/concesionario/boot" class="btn btn-primary me-2">
                                    <i class="bi bi-arrow-left-circle"></i> Volver al listado
                                </a>
                                <a href="#" class="btn btn-success">
                                    <i class="bi bi-cart-plus"></i> Comprar
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
</odoo>
